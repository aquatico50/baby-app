/* ---- THEME ---- */
:root{
  --purple-900:#2a0f63;
  --purple-700:#6d28d9;
  --purple-500:#a78bfa;
  --white-90:rgba(255,255,255,.92);
  --white-70:rgba(255,255,255,.70);
  --white-18:rgba(255,255,255,.18);
  --white-28:rgba(255,255,255,.28);
}

*{box-sizing:border-box}
html,body,#root{height:100%}
body{
  margin:0;
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  color:#fff;
  background:#0b0329;
}

/* ---- APP BACKGROUND ---- */
.app-bg{
  min-height:100%;
  background:
    radial-gradient(1200px 600px at 85% -10%, #b794f4 0%, rgba(183,148,244,0) 60%),
    radial-gradient(900px 500px at 10% 0%, #7c3aed 0%, rgba(124,58,237,0) 50%),
    linear-gradient(135deg, #2b146b 0%, #4b1fb3 45%, #6d28d9 100%);
  padding:16px 16px 96px;
}

/* ---- GLASS CARD ---- */
.card{
  background:rgba(15,15,30,.35);
  border:1px solid var(--white-18);
  border-radius:18px;
  padding:14px;
  box-shadow:0 12px 28px rgba(0,0,0,.35);
  backdrop-filter: blur(14px) saturate(160%);
}

/* ---- HEADER + MENU ---- */
.app-header{
  position:sticky; top:0; z-index:10;
  margin-bottom:12px; padding:12px 14px;
  border-radius:18px; background:rgba(15,15,30,.45);
  border:1px solid var(--white-18); backdrop-filter:blur(12px) saturate(160%);
  display:flex; align-items:center; justify-content:space-between; gap:12px;
}
.app-title{margin:0;font-size:22px;font-weight:900;letter-spacing:.2px}
.app-sub{margin:2px 0 0;color:var(--white-70);font-size:12px}
.menu-btn{
  border:none; border-radius:12px; padding:10px 14px; font-weight:800; color:#fff;
  background:linear-gradient(90deg,#7c3aed,#a78bfa); box-shadow:0 10px 18px rgba(124,58,237,.35);
}

/* ---- MENU POPUP ---- */
.menu{
  position:absolute; right:0; top:110%;
  background:rgba(15,15,30,.9); border:1px solid var(--white-28);
  border-radius:14px; padding:8px; display:grid; gap:6px; min-width:190px;
}
.menu-item{
  border:none; text-align:left; color:#fff; padding:10px 12px; border-radius:10px;
  background:rgba(255,255,255,.08); box-shadow:inset 0 0 0 1px var(--white-18);
}
.menu-item.active{ background:linear-gradient(90deg,#7c3aed,#a78bfa); }

/* ---- INPUTS / BUTTONS ---- */
.input, .select{
  border-radius:12px; border:1px solid var(--white-28);
  background:rgba(255,255,255,.14); color:#fff; padding:10px 12px;
}
.input::placeholder{color:var(--white-70)}
.btn{
  border:none; border-radius:12px; padding:10px 14px; font-weight:800; color:#fff;
  background:linear-gradient(90deg,#5b21b6,#7c3aed); box-shadow:0 10px 18px rgba(91,33,182,.35);
}

/* ---- DAY GRID (borders + sticky times) ---- */
.day-grid{ display:grid; grid-template-columns:1fr; gap:6px; width:100% }
.day-hour{
  display:grid; grid-template-columns:72px 1fr; gap:10px; align-items:start;
  border-bottom:1px solid var(--white-18); padding-bottom:8px;
}
.day-hour-label{ font-weight:900; color:var(--white-90) }
.day-hour-items{ display:grid; gap:8px }

/* ---- TASK CHIP ---- */
.task{
  display:flex; justify-content:space-between; align-items:center; gap:8px;
  background:rgba(255,255,255,.10); border:1px solid var(--white-18);
  border-radius:14px; padding:10px 12px;
}
.task--done{ opacity:.75 }
.task-meta{ color:var(--white-70); font-size:12px }

/* ---- MONTH ---- */
.month-grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:8px; width:100% }
.month-head{ text-align:center; font-weight:800; color:var(--white-90) }
.month-cell{
  padding:8px; border-radius:12px; min-height:96px;
  background:rgba(15,15,30,.35); border:1px solid var(--white-18);
  display:flex; flex-direction:column; gap:6px; min-width:0;
}
.month-fade{ opacity:.55 }
.month-date-row{ display:flex; justify-content:space-between; align-items:center; }
.month-date{ font-weight:900; color:#fff; background:transparent; border:none }
.month-add{
  width:26px; height:26px; border:none; border-radius:999px; color:#fff;
  background:linear-gradient(90deg,#7c3aed,#a78bfa);
}
.month-items{ display:grid; gap:4px }
.month-chip{
  font-size:12px; padding:4px 6px; border-radius:8px;
  background:rgba(255,255,255,.12); border:1px solid var(--white-18);
}
.month-chip-done{ text-decoration:line-through; opacity:.85 }

/* ---- YEAR ---- */
.year-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:12px }
.year-cell{ padding:10px; border-radius:12px; background:rgba(15,15,30,.35); border:1px solid var(--white-18) }
.year-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px }

/* ---- TOAST ---- */
.toast{
  position:fixed; left:50%; bottom:20px; transform:translateX(-50%);
  background:rgba(0,0,0,.85); color:#fff; border-radius:999px; padding:10px 16px;
  box-shadow:0 8px 24px rgba(0,0,0,.4); z-index:60;
}
.spacer{height:24px}

/* ---- Action bubble (long-press) ---- */
.action-bubble{
  position:absolute; right:8px; top:-8px; z-index:5;
  background:rgba(0,0,0,.8); border:1px solid var(--white-28);
  color:#fff; border-radius:12px; padding:6px; display:flex; gap:6px;
}

/* Center header + cards and constrain width so they fit */
.app-header, .card{ max-width:900px; margin:0 auto; }

/* On very small screens, tighten paddings */
@media (max-width: 420px){
  .card { padding:10px; }
  .month-grid { gap:6px; }
  .month-cell { padding:6px; }
}

/* =========================
   COUPON STYLES
   ========================= */

.coupon{
  position: relative;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 12px;
  align-items: center;
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px dashed var(--white-28);
  background:
    radial-gradient(120% 180% at 100% 0%, rgba(167,139,250,.18), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.55);
  box-shadow: 0 10px 24px rgba(0,0,0,.35);
  backdrop-filter: blur(10px) saturate(150%);
  overflow:hidden;
}

/* side notches that cut into the card */
.coupon::before,
.coupon::after{
  content:"";
  position:absolute;
  width:18px; height:18px;
  background:#0b0329; /* page bg to "cut out" */
  border-radius:50%;
  top:50%; transform:translateY(-50%);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.12);
}
.coupon::before{ left:-9px; }
.coupon::after{  right:-9px; }

/* perforation line */
.coupon .cut{
  position:absolute; left:50%; top:8px; bottom:8px;
  width:2px; transform:translateX(-50%);
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,.35), rgba(255,255,255,.35) 6px,
    rgba(255,255,255,0) 6px, rgba(255,255,255,0) 12px
  );
  opacity:.6;
  z-index:4; /* above sparkles */
}

/* Content text */
.coupon .title{ font-weight:900; }
.coupon .tier{ font-size:12px; color:var(--white-70); }

/* points badge */
.badge{
  align-self:start;
  padding:6px 10px;
  border-radius:999px;
  font-weight:800;
  background:linear-gradient(90deg,#7c3aed,#a78bfa);
  box-shadow:0 8px 18px rgba(124,58,237,.35);
}

/* “held” coupons (in the Coupon Box) */
.coupon--held{
  border-style:solid;
  background:
    radial-gradient(120% 180% at 0% 0%, rgba(183,148,244,.18), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.6);
}

/* smaller coupon layout on tiny screens */
@media (max-width: 420px){
  .coupon{ grid-template-columns:1fr; }
  .badge{ justify-self:start; }
}

/* Tier looks */
.coupon .emoji{ font-size:22px; margin-right:8px }
.coupon .title-row{ display:flex; align-items:center; gap:8px }

.coupon--small{
  border-color: rgba(205,127,50,.55); /* bronze */
  box-shadow: 0 10px 24px rgba(205,127,50,.18);
  background:
    linear-gradient(180deg, rgba(205,127,50,.12), rgba(0,0,0,0) 60%),
    radial-gradient(120% 180% at 100% 0%, rgba(205,127,50,.22), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.55);
}
.coupon--small .badge{
  background: linear-gradient(90deg,#b87333,#cd7f32);
  box-shadow: 0 8px 18px rgba(205,127,50,.35);
}

.coupon--medium{
  border-color: rgba(192,192,192,.55); /* silver */
  box-shadow: 0 10px 24px rgba(192,192,192,.18);
  background:
    linear-gradient(180deg, rgba(192,192,192,.12), rgba(0,0,0,0) 60%),
    radial-gradient(120% 180% at 100% 0%, rgba(192,192,192,.26), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.58);
}
.coupon--medium .badge{
  background: linear-gradient(90deg,#9ea7ad,#c0c0c0);
  box-shadow: 0 8px 18px rgba(192,192,192,.35);
}

.coupon--large{
  border-color: rgba(255,215,0,.55);   /* gold */
  box-shadow: 0 10px 24px rgba(255,215,0,.20);
  background:
    linear-gradient(180deg, rgba(255,215,0,.10), rgba(0,0,0,0) 60%),
    radial-gradient(120% 180% at 100% 0%, rgba(255,215,0,.24), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.60);
}
.coupon--large .badge{
  background: linear-gradient(90deg,#d4af37,#ffd700);
  box-shadow: 0 8px 18px rgba(255,215,0,.35);
}

.coupon--special{
  border-color: rgba(229,228,226,.65); /* platinum */
  box-shadow: 0 12px 26px rgba(229,228,226,.24);
  background:
    linear-gradient(180deg, rgba(229,228,226,.12), rgba(0,0,0,0) 60%),
    radial-gradient(120% 180% at 100% 0%, rgba(229,228,226,.28), rgba(0,0,0,0) 60%),
    rgba(15,15,30,.63);
}
.coupon--special .badge{
  background: linear-gradient(90deg,#cfd2d3,#e5e4e2);
  box-shadow: 0 8px 18px rgba(229,228,226,.40);
}

/* ===== Sparkle overlay (elements so it won't clash with notches) ===== */
@keyframes fxTwinkle {
  0%,100% { opacity:.18; transform: translateY(0) }
  50%     { opacity:.38; transform: translateY(-2px) }
}
@keyframes fxSheen {
  0%   { transform: translate(-140%, -140%) rotate(18deg); }
  50%  { transform: translate(10%, 10%) rotate(18deg); }
  100% { transform: translate(140%, 140%) rotate(18deg); }
}

.coupon > :not(.fx-stars):not(.fx-sheen) { position: relative; z-index: 1; }
.coupon .cut { z-index: 4; } /* keep perforation line on top */

/* starfield layer */
.coupon .fx-stars{
  position:absolute; inset:0; z-index:0; pointer-events:none;
  background:
    radial-gradient(2px 2px at 12% 22%, rgba(255,255,255,.55), transparent 60%),
    radial-gradient(2px 2px at 82% 28%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(1.6px 1.6px at 28% 68%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(1.6px 1.6px at 62% 48%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(1.6px 1.6px at 90% 80%, rgba(255,255,255,.45), transparent 60%);
  animation: fxTwinkle 4.2s ease-in-out infinite;
  mix-blend-mode: screen;
}

/* sweeping sheen layer */
.coupon .fx-sheen{
  position:absolute; z-index:3; pointer-events:none;
  width: 220%; height: 220%;
  left:-60%; top:-60%;
  background: linear-gradient(125deg,
    rgba(255,255,255,0) 42%,
    rgba(255,255,255,.55) 50%,
    rgba(255,255,255,0) 58%
  );
  animation: fxSheen 2.8s linear infinite;
  mix-blend-mode: screen;
}

/* accessibility */
@media (prefers-reduced-motion: reduce){
  .coupon .fx-stars, .coupon .fx-sheen { animation: none; }
}

/* === Universal Coupon Layout for Android + Safari === */

.coupon {
  position: relative;
  padding: 16px;
  padding-bottom: 64px;   /* Space for badge + button */
  min-height: 140px;
  isolation: isolate;     /* Required for Safari blend modes */
  overflow: hidden;
  border-radius: 12px;
}

/* Keep title and tier info up top */
.coupon .title,
.coupon .tier {
  margin: 0;
  position: relative;
  z-index: 3;
}

/* Points badge bottom-left */
.coupon .badge {
  position: absolute;
  left: 16px;
  bottom: 16px;
  margin: 0;
  z-index: 4;
}

/* Redeem button bottom-right */
.coupon .btn {
  position: absolute;
  right: 16px;
  bottom: 16px;
  margin: 0;
  z-index: 4;
}

/* Sparkle + shine overlay */
.coupon .fx-stars,
.coupon .fx-sheen {
  position: absolute;
  inset: 0;
  z-index: 5;             /* Over text & buttons */
  pointer-events: none;
  opacity: 0.45;
  will-change: opacity, transform;
}

/* Make Safari render blend effects properly */
@supports (-webkit-backdrop-filter: blur(1px)) {
  .coupon .fx-stars,
  .coupon .fx-sheen {
    mix-blend-mode: lighten;
    -webkit-transform: translateZ(0);
  }
}

/* Optional: subtle animation for sparkle movement */
.coupon .fx-stars {
  animation: sparkle-move 6s linear infinite;
}

@keyframes sparkle-move {
  0%   { transform: translate(0, 0); }
  100% { transform: translate(-10px, -10px); }
}


/* ===== Cross-browser coupon layout (Android + Safari + Firefox) ===== */

/* Two columns: text left, actions right (fixed width) */
.coupon{
  position: relative;
  display: grid;
  grid-template-columns: 1fr 132px;   /* actions column is fixed so it never shifts */
  grid-auto-rows: minmax(140px, auto);
  column-gap: 14px;
  padding: 16px;
  border-radius: 12px;
  overflow: hidden;
  isolation: isolate;                 /* stable stacking context for all browsers */
}

/* left column (first inner DIV = title/tier) */
.coupon > div:nth-of-type(1){
  min-width: 0;                        /* allow wrapping */
  align-self: start;
  position: relative;
  z-index: 3;
}

/* right column (second inner DIV = badge + button) */
.coupon > div:nth-of-type(2){
  display: grid;
  grid-template-rows: auto 1fr auto;   /* badge on top, spacer, button bottom */
  align-items: end;
  justify-items: end;
  row-gap: 10px;
  position: relative;
  z-index: 3;
}

/* ensure badge + button aren’t absolutely positioned anywhere else */
.coupon .badge,
.coupon .btn{
  position: static !important;
  margin: 0 !important;
}

/* keep text above background */
.coupon .title,
.coupon .tier{
  position: relative;
  z-index: 3;
}

/* sparkle layers: visible everywhere without blend quirks */
.coupon .fx-stars,
.coupon .fx-sheen{
  position: absolute;
  inset: 0;
  z-index: 4;                          /* OVER text, badge, and button as requested */
  pointer-events: none;
  opacity: .35;                         /* looks good on Safari/Firefox/Android */
  will-change: transform, opacity;
}

/* Safari tweak (detects WebKit backdrop support) */
@supports (-webkit-backdrop-filter: blur(1px)){
  .coupon .fx-stars,
  .coupon .fx-sheen{
    opacity: .42;                       /* a touch brighter on Safari */
  }
}

/* keep the perforation cut line on top of sparkles */
.coupon .cut{ z-index: 6; }

/* small-screen tightening (optional) */
@media (max-width: 420px){
  .coupon{ grid-template-columns: 1fr 120px; padding: 14px; }
}
